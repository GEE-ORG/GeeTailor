!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.GeeTailor=i()}(this,function(){"use strict";function t(t,i){function n(t,i){Object.keys(i).forEach(function(o){if(o in t){var h=e(t[o]);"[object Object]"===h||"[object Array]"===h?(t[o]=Object.create(t[o]),n(t[o],i[o])):t[o]=i[o]}})}var o=Object.create(t);return n(o,i),o}function i(t){if("undefined"!=typeof Promise&&n(Promise))Promise.resolve().then(function(){t()}).catch(function(t){return console.error(t)});else if("undefined"==typeof MutationObserver||!n(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())setTimeout(t,0);else{var i=new MutationObserver(t),e=document.createTextNode(o+"");i.observe(e,{characterData:!0}),e.data=++o+"",o=0}}function e(t){return Object.prototype.toString.call(t)}function n(t){return/[native code]/.test(t.toString())}var o=0,h=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},s=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),a={width:800,height:500};return function(){function e(n,o){h(this,e),this.btns={},this.img={width:0,height:0},this.el="string"==typeof n?document.querySelector(n):n,this.option=t(a,o),this.el.innerHTML='\n    <canvas class="gt-img" style="background-color: rgba(0,0,0,.8)"></canvas>\n    <input class="gt-upload" type="file" accept="image/jpg,image/png" style="display: none">\n    <section class="gt-ctrl">\n        <button class="gt-ctrl_upload">Upload</button>\n        <button class="gt-ctrl_export">Export</button>\n    </section>\n',i(this.init.bind(this))}return s(e,[{key:"init",value:function(){this.canvas=this.el.querySelector(".gt-img"),this.ctx=this.canvas.getContext("2d"),this.ctx.imageSmoothingEnabled=!1,this.canvasInit(),this.upload=this.el.querySelector(".gt-upload"),this.btns.upload=this.el.querySelector(".gt-ctrl_upload"),this.addEvents(),"avatar"===this.mode&&this.drawCircleMask(),console.log(this)}},{key:"canvasInit",value:function(){this.canvas.width=this.option.width,this.canvas.height=this.option.height,this.canvas.style.width=this.canvas.width/window.devicePixelRatio+"px",this.canvas.style.height=this.canvas.height/window.devicePixelRatio+"px"}},{key:"drawBg",value:function(){}},{key:"drawImg",value:function(){}},{key:"drawMask",value:function(){}},{key:"drawCircleMask",value:function(){var t=this,i=new Image,e=new Blob(['\n<svg width="100px" height="100px" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    <path d="M0,0 L100,0 L100,100 L0,100 L0,0 Z M50,100 C77.6142375,100 100,77.6142375 100,50 C100,22.3857625 77.6142375,0 50,0 C22.3857625,0 0,22.3857625 0,50 C0,77.6142375 22.3857625,100 50,100 Z" id="Combined-Shape" stroke="none" fill-opacity="0.5" fill="#000000" fill-rule="evenodd"></path>\n</svg>'],{type:"image/svg+xml"});i.onload=function(){var e=t.option.width>t.option.height?t.option.height:t.option.width,n=(t.option.width-e)/2,o=(t.option.height-e)/2;console.log(t.option.width,t.option.height,n,o,e),t.ctx.drawImage(i,n,o,e,e)},i.src=URL.createObjectURL(e)}},{key:"addEvents",value:function(){var t=this;this.btns.upload.addEventListener("click",function(){t.upload.click()}),this.upload.addEventListener("change",function(i){var e=i.target.files[0];if(!/image\/(jpg|jpeg|png)/.test(e.type))return void console.error("Only support jpg and png format.");var n=new Image;n.onload=function(){t.setImg(n)},n.src=URL.createObjectURL(e)}),document.addEventListener("wheel",function(i){i.target===t.canvas&&console.log(i.wheelDeltaY)})}},{key:"setImg",value:function(t){this.option,URL.revokeObjectURL(t.src),this.img.width=t.width,this.img.height=t.height;var i=(t.width,t.height,{width:t.width,height:t.height,offsetX:0,offsetY:0});if(t.width>this.option.width){var e=this.option.width/t.width;i.width=this.option.width,i.height=e*i.height}if(t.height>this.option.height){var n=this.option.height/i.height;i.height=this.option.height,i.width*=n}i.offsetX=(this.option.width-i.width)/2,i.offsetY=(this.option.height-i.height)/2,this.ctx.clearRect(0,0,this.option.width,this.option.height),this.ctx.drawImage(t,i.offsetX,i.offsetY,i.width,i.height),"avatar"===this.mode&&this.drawCircleMask()}},{key:"mode",set:function(t){switch(t){case"avatar":this.option.width>this.option.height?this.canvas.width=this.option.width=this.option.height:this.canvas.height=this.option.height=this.canvas.width}this.canvasInit(),this._mode=t},get:function(){return this._mode}}]),e}()});
//# sourceMappingURL=GeeTailor.js.map
